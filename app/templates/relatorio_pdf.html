{% extends "base.html" %}
{% block title %}Astral Report • SkyAI{% endblock %}
{% block body_class %}report-page{% endblock %}

{% block content %}
<div class="report-box" style="max-width: 800px; margin: 2rem auto; font-family: Arial, sans-serif; padding: 2rem; background: #ffffff; color: #111;">
  
  <div style="text-align: center;">
    <img src="{{ url_for('static', filename='img/logo_skyai.png') }}" alt="SkyAI Logo" style="max-height: 60px; margin-bottom: 1.5rem;">
    <h1 style="color: #222;">Your Personalized Astral Report</h1>
  </div>

  {% if resultado.erro %}
    <div class="error-msg" style="margin-top: 1.5rem; background: #ffe6e6; padding: 1rem; border-radius: 8px;">
      <p style="color: #c00;">🚧 We couldn't complete your astral reading with AI at this moment. Showing fallback information instead.</p>
      <p><strong>Error Details:</strong> {{ resultado.erro }}</p>
    </div>
  {% endif %}

  <div class="section" style="margin-top: 2rem;">
    <h2 style="color: #333; font-size: 1.4rem; margin-bottom: 1rem;">🌟 Profile Summary</h2>
    <ul style="padding-left: 1.5rem;">
      <li><strong>🌟 Full Name:</strong> {{ resultado.nome or '—' }}</li>
      <li><strong>🗅️ Date of Birth:</strong> {{ resultado.birth_date or '—' }}</li>
      <li><strong>🕰️ Time of Birth:</strong> {{ resultado.birth_time or '—' }}</li>
      <li><strong>🌍 City of Birth:</strong> {{ resultado.birth_city or '—' }}</li>
      <li><strong>🌎 Country:</strong> {{ resultado.birth_country or '—' }}</li>
    </ul>
  </div>

  <div class="section" style="margin-top: 2rem;">
    <h2 style="color: #333; font-size: 1.4rem; margin-bottom: 1rem;">🌟 Cosmic Insights</h2>
    {% set blocos = resultado.texto.split('## ') %}
    {% for bloco in blocos %}
      {% set texto = bloco.strip() %}
      {% if texto %}
        <div class="ai-summary-item" style="margin-bottom: 1.5rem;">
          {% set partes = texto.split(':', 1) %}
          {% if partes|length > 1 and partes[0]|length < 70 %}
            <h3 style="color: #555; font-size: 1.1rem; margin-bottom: 0.5rem;">{{ partes[0]|replace('###','')|trim }}</h3>
            <p style="margin: 0;">{{ partes[1]|trim }}</p>
          {% else %}
            <p style="margin: 0;">{{ texto|replace('###','') }}</p>
          {% endif %}
        </div>
      {% endif %}
    {% endfor %}
  </div>

  <div class="section" style="margin-top: 2rem;">
    <h2 style="color: #333; font-size: 1.4rem; margin-bottom: 1rem;">🔍 Your Celestial Signatures</h2>
    <ul style="padding-left: 1.5rem;">
      <li><strong>Sun Sign:</strong> {{ resultado.sun_sign or '—' }}</li>
      <li><strong>Moon Sign:</strong> {{ resultado.moon_sign or '—' }}</li>
      <li><strong>Ascendant:</strong> {{ resultado.ascendant or '—' }}</li>
      <li><strong>Life Path Number:</strong> {{ resultado.life_path or '—' }}</li>
      <li><strong>Soul Urge Number:</strong> {{ resultado.soul_urge or '—' }}</li>
      <li><strong>Expression Number:</strong> {{ resultado.expression or '—' }}</li>
    </ul>
  </div>

  <div style="text-align: center; margin-top: 2rem;">
    <p style="font-size: 0.9rem; color: #666;">Generated by SkyAI • © {{ current_year or 2025 }}</p>
  </div>
</div>
{% endblock %}
