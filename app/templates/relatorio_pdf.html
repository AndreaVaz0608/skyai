{% extends "base.html" %}
{% block title %}Astral Report • SkyAI{% endblock %}
{% block body_class %}report-page{% endblock %}

{% block content %}

<!-- ======= CONTÊINER PRINCIPAL ======= -->
<div style="max-width: 860px; margin:2rem auto; padding:0 1rem;">

  <!-- ---------- Cabeçalho ---------- -->
  <div style="text-align:center; margin-bottom:2rem;">
      <img src="{{ url_for('static', filename='img/logo_skyai.png') }}"
           alt="SkyAI Logo" style="max-height:70px">
      <h1 style="margin-top:.8rem; font-size:2rem; color:#FFD86A;">
          🌌 Your Personalized Astral Report
      </h1>
  </div>

  <!-- ---------- bloco de erro ---------- -->
  {% if resultado.erro %}
    <div style="background:#401010; padding:1rem 1.4rem; border-radius:8px;
                color:#FF9E9E; margin-bottom:1.8rem;">
        🚧 We couldn’t complete your astral reading.<br>
        <small><strong>Error:</strong> {{ resultado.erro }}</small>
    </div>
  {% endif %}

  <!-- ---------- PROFILE SUMMARY ---------- -->
  <section style="background:#111C2C; border-radius:10px; padding:1.4rem 1.6rem; margin-bottom:1.8rem;">
     <h2 style="color:#FFD86A; font-size:1.35rem; margin-top:0;">🗂️ Profile Summary</h2>
     <ul style="list-style:none; padding:0; margin-top:.8rem; font-size:1rem; line-height:1.55rem; color:#EAEAEA;">
        <li><span style="color:#FFD86A;">🌟 Full Name:</span> {{ resultado.nome|default('—') }}</li>
        <li><span style="color:#FFD86A;">🗅️ Date of Birth:</span> {{ resultado.birth_date|default('—') }}</li>
        <li><span style="color:#FFD86A;">🕰️ Time of Birth:</span> {{ resultado.birth_time|default('—') }}</li>
        <li><span style="color:#FFD86A;">🌍 City:</span> {{ resultado.birth_city|default('—') }}</li>
        <li><span style="color:#FFD86A;">🌎 Country:</span> {{ resultado.birth_country|default('—') }}</li>
     </ul>
  </section>

  <!-- ---------- COSMIC INSIGHTS ---------- -->
  <section style="background:#111C2C; border-radius:10px; padding:1.4rem 1.6rem; margin-bottom:1.8rem;">
     <h2 style="color:#FFD86A; font-size:1.35rem; margin-top:0;">🔭 Cosmic Insights</h2>

     {% set texto_bruto = resultado.texto|default('') %}
     {% if texto_bruto %}
        {% for bloco in texto_bruto.split('## ') if bloco.strip() %}
           {% set bloco_limpo = bloco|trim %}
           <div style="margin:.9rem 0;">
               {% set partes = bloco_limpo.split(':', 1) %}
               {% if partes|length > 1 and partes[0]|length < 70 %}
                   <h3 style="color:#FFD86A; font-size:1.1rem; margin-bottom:.3rem;">
                       {{ partes[0]|replace('###','')|trim }}
                   </h3>
                   <p style="margin:0; color:#EAEAEA;">{{ partes[1]|trim }}</p>
               {% else %}
                   <p style="margin:0; color:#EAEAEA;">{{ bloco_limpo|replace('###','') }}</p>
               {% endif %}
           </div>
        {% endfor %}
     {% else %}
        <p style="color:#EAEAEA;">— Insights not available —</p>
     {% endif %}
  </section>

  <!-- ---------- SIGNATURES / NUMBERS ---------- -->
  <section style="background:#111C2C; border-radius:10px; padding:1.4rem 1.6rem;">
     <h2 style="color:#FFD86A; font-size:1.35rem; margin-top:0;">🔑 Celestial Signatures</h2>
     <ul style="list-style:none; padding:0; margin-top:.8rem; font-size:1rem; line-height:1.55rem; color:#EAEAEA;">
        <li><span style="color:#FFD86A;">☀ Sun Sign:</span> {{ resultado.sun_sign|default('—') }}</li>
        <li><span style="color:#FFD86A;">🌙 Moon Sign:</span> {{ resultado.moon_sign|default('—') }}</li>
        <li><span style="color:#FFD86A;">⬆ Ascendant:</span> {{ resultado.ascendant|default('—') }}</li>
        <li><span style="color:#FFD86A;">🔢 Life Path:</span> {{ resultado.life_path|default('—') }}</li>
        <li><span style="color:#FFD86A;">💓 Soul Urge:</span> {{ resultado.soul_urge|default('—') }}</li>
        <li><span style="color:#FFD86A;">✨ Expression:</span> {{ resultado.expression|default('—') }}</li>
     </ul>
  </section>

  <p style="text-align:center; color:#6A768C; font-size:.85rem; margin-top:2rem;">
      Generated by SkyAI • © {{ current_year|default(2025) }}
  </p>

</div>
{% endblock %}
